{"version":3,"file":"brunoc-ngx-viacep.js","sources":["../../../projects/brunoc/ngx-viacep/src/lib/ngx-viacep.module.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/cep-error-code.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/cep-error.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/constantes.ts","../../../projects/brunoc/ngx-viacep/src/lib/utils/index.ts","../../../projects/brunoc/ngx-viacep/src/lib/ngx-viacep.service.ts","../../../projects/brunoc/ngx-viacep/src/public-api.ts","../../../projects/brunoc/ngx-viacep/src/brunoc-ngx-viacep.ts"],"names":[],"mappings":"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","sourcesContent":["import { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    HttpClientModule\n  ],\n  exports: [\n    \n  ]\n})\nexport class NgxViacepModule { }\n","// eslint-disable-next-line no-shadow\nexport enum CEPErrorCode {\n  CEP_NAO_ENCONTRADO,\n  CEP_VAZIO,\n  CEP_INVALIDO,\n  CEP_MUITO_CURTO,\n  CEP_MUITO_LONGO,\n  UF_VAZIA,\n  UF_MUITO_CURTA,\n  UF_MUITO_LONGA,\n  UF_NAO_EXISTE,\n  MUNICIPIO_VAZIO,\n  MUNICIPIO_MUITO_CURTO,\n  LOGRADOURO_VAZIO,\n  LOGRADOURO_MUITO_CURTO,\n  ERRO_SERVIDOR,\n}\n","import { CEPErrorCode } from './cep-error-code';\n\nexport class CEPError extends Error {\n  constructor(private code: CEPErrorCode) {\n    super(CEPErrorCode[code]);\n    Object.setPrototypeOf(this, CEPError.prototype);\n  }\n\n  /**\n   * Returns the Error code\n   */\n  getCode(): CEPErrorCode {\n    return this.code;\n  }\n}\n","export const BASE_URL = 'https://viacep.com.br/ws';\n\nexport const UFS_VALIDAS: string[] = [\n  'AC',\n  'AL',\n  'AM',\n  'AP',\n  'BA',\n  'CE',\n  'DF',\n  'ES',\n  'GO',\n  'MA',\n  'MG',\n  'MS',\n  'MT',\n  'PA',\n  'PB',\n  'PE',\n  'PI',\n  'PR',\n  'RJ',\n  'RN',\n  'RO',\n  'RR',\n  'RS',\n  'SC',\n  'SE',\n  'SP',\n  'TO',\n];\n","import { CEPError } from '../model/cep-error';\nimport { CEPErrorCode } from '../model/cep-error-code';\nimport { UFS_VALIDAS } from '../model/constantes';\nimport { Observable } from 'rxjs';\n\nconst throwCepError = (error: CEPErrorCode) => {\n  throw new CEPError(error);\n};\n\nconst ehStringValida = (data: string): boolean => !!data && data.trim() !== '';\n\nconst hasMinLength = (data: string, minLength: number): boolean =>\n  data.trim().length >= minLength;\n\nconst hasMaxLength = (data: string, maxLength: number): boolean =>\n  data.trim().length <= maxLength;\n\nconst validarMunicipio = (municipio: string): void => {\n  if (!ehStringValida(municipio)) {\n    throwCepError(CEPErrorCode.MUNICIPIO_VAZIO);\n  }\n\n  if (!hasMinLength(municipio, 3)) {\n    throwCepError(CEPErrorCode.MUNICIPIO_MUITO_CURTO);\n  }\n};\n\nconst validarLogradouro = (logradouro: string): void => {\n  if (!ehStringValida(logradouro)) {\n    throwCepError(CEPErrorCode.LOGRADOURO_VAZIO);\n  }\n\n  if (!hasMinLength(logradouro, 3)) {\n    throwCepError(CEPErrorCode.LOGRADOURO_MUITO_CURTO);\n  }\n};\n\nconst validarUF = (uf: string): void => {\n  if (!ehStringValida(uf)) {\n    throwCepError(CEPErrorCode.UF_VAZIA);\n  }\n\n  if (!hasMinLength(uf, 2)) {\n    throwCepError(CEPErrorCode.UF_MUITO_CURTA);\n  }\n\n  if (!hasMaxLength(uf, 2)) {\n    throwCepError(CEPErrorCode.UF_MUITO_LONGA);\n  }\n\n  if (!UFS_VALIDAS.some((it) => it.toLowerCase() === uf.toLowerCase())) {\n    throwCepError(CEPErrorCode.UF_NAO_EXISTE);\n  }\n};\n\nexport const validarCEP = () => (\n  source: Observable<string>\n): Observable<string> =>\n  new Observable((subscriber) =>\n    source.subscribe({\n      next: (cep) => {\n        try {\n          const regex = new RegExp(/^[0-9]+$/);\n          if (!ehStringValida(cep)) {\n            throwCepError(CEPErrorCode.CEP_VAZIO);\n          }\n          if (!regex.test(cep)) {\n            throwCepError(CEPErrorCode.CEP_INVALIDO);\n          }\n          if (cep.length < 8) {\n            throwCepError(CEPErrorCode.CEP_MUITO_CURTO);\n          }\n          if (cep.length > 8) {\n            throwCepError(CEPErrorCode.CEP_MUITO_LONGO);\n          }\n          subscriber.next(cep.trim());\n        } catch (e) {\n          subscriber.error(e);\n        }\n      },\n      error: (error) => subscriber.error(error),\n      complete: () => subscriber.complete(),\n    })\n  );\n\ninterface EnderecoPesquisa {\n  uf: string;\n  logradouro: string;\n  municipio: string;\n}\n\nexport const validarEndereco = () => (\n  source: Observable<EnderecoPesquisa>\n): Observable<EnderecoPesquisa> =>\n  new Observable((subscriber) =>\n    source.subscribe({\n      next: ({ uf, logradouro, municipio }) => {\n        try {\n          validarUF(uf);\n          validarMunicipio(municipio);\n          validarLogradouro(logradouro);\n        } catch (e) {\n          subscriber.error(e);\n        }\n        subscriber.next({ uf, logradouro, municipio });\n      },\n      error: (error) => subscriber.error(error),\n      complete: () => subscriber.complete(),\n    })\n  );\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, of } from 'rxjs';\nimport { Endereco } from './model/endereco';\nimport { CEPErrorCode } from './model/cep-error-code';\nimport { CEPError } from './model/cep-error';\nimport { BASE_URL } from './model/constantes';\nimport { validarCEP, validarEndereco } from './utils';\nimport { map, switchMap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NgxViacepService {\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Busca o endere√ßo a partir do CEP\n   *\n   * @param cep\n   */\n  buscarPorCep(cep: string): Observable<Endereco> {\n    return of(cep).pipe(\n      validarCEP(),\n      switchMap((cepValido) =>\n        this.http.get<Endereco>(`${BASE_URL}/${cepValido}/json`)\n      ),\n      map((endereco) => {\n        if ('cep' in endereco) {\n          return endereco;\n        }\n        throw new CEPError(CEPErrorCode.CEP_NAO_ENCONTRADO);\n      })\n    );\n  }\n\n  /**\n   * Faz a busca aproximada\n   *\n   * @param uf\n   * @param municipio\n   * @param logradouro\n   */\n  buscarPorEndereco(\n    uf: string,\n    municipio: string,\n    logradouro: string\n  ): Observable<Endereco[]> {\n    return of({ uf, municipio, logradouro }).pipe(\n      validarEndereco(),\n      switchMap(() =>\n        this.http.get<Endereco[]>(\n          `${BASE_URL}/${uf}/${municipio}/${logradouro}/json`\n        )\n      )\n    );\n  }\n}\n","/*\n * Public API Surface of ngx-viacep\n */\n\nexport * from './lib/ngx-viacep.module';\nexport * from './lib/ngx-viacep.service';\nexport * from './lib/model/endereco';\nexport * from './lib/model/cep-error-code';\nexport * from './lib/model/cep-error';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}