{"version":3,"file":"brunoc-ngx-viacep.js","sources":["../../../projects/brunoc/ngx-viacep/src/lib/ngx-viacep.module.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/cep-error-code.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/cep-error.ts","../../../projects/brunoc/ngx-viacep/src/lib/model/constantes.ts","../../../projects/brunoc/ngx-viacep/src/lib/utils/index.ts","../../../projects/brunoc/ngx-viacep/src/lib/ngx-viacep.service.ts","../../../projects/brunoc/ngx-viacep/src/public-api.ts","../../../projects/brunoc/ngx-viacep/src/brunoc-ngx-viacep.ts"],"sourcesContent":["import { HttpClientModule } from '@angular/common/http';\nimport { NgModule } from '@angular/core';\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    HttpClientModule\n  ],\n  exports: [\n    \n  ]\n})\nexport class NgxViacepModule { }\n","// eslint-disable-next-line no-shadow\nexport enum CEPErrorCode {\n  CEP_NAO_ENCONTRADO,\n  CEP_VAZIO,\n  CEP_INVALIDO,\n  CEP_MUITO_CURTO,\n  CEP_MUITO_LONGO,\n  UF_VAZIA,\n  UF_MUITO_CURTA,\n  UF_MUITO_LONGA,\n  UF_NAO_EXISTE,\n  MUNICIPIO_VAZIO,\n  MUNICIPIO_MUITO_CURTO,\n  LOGRADOURO_VAZIO,\n  LOGRADOURO_MUITO_CURTO,\n  ERRO_SERVIDOR,\n}\n","import { CEPErrorCode } from './cep-error-code';\n\nexport class CEPError extends Error {\n  constructor(private code: CEPErrorCode) {\n    super(CEPErrorCode[code]);\n    Object.setPrototypeOf(this, CEPError.prototype);\n  }\n\n  /**\n   * Returns the Error code\n   */\n  getCode(): CEPErrorCode {\n    return this.code;\n  }\n}\n","export const BASE_URL = 'https://viacep.com.br/ws';\n\nexport const UFS_VALIDAS: string[] = [\n  'AC',\n  'AL',\n  'AM',\n  'AP',\n  'BA',\n  'CE',\n  'DF',\n  'ES',\n  'GO',\n  'MA',\n  'MG',\n  'MS',\n  'MT',\n  'PA',\n  'PB',\n  'PE',\n  'PI',\n  'PR',\n  'RJ',\n  'RN',\n  'RO',\n  'RR',\n  'RS',\n  'SC',\n  'SE',\n  'SP',\n  'TO',\n];\n","import { CEPError } from '../model/cep-error';\nimport { CEPErrorCode } from '../model/cep-error-code';\nimport { UFS_VALIDAS } from '../model/constantes';\nimport { Observable } from 'rxjs';\n\nconst throwCepError = (error: CEPErrorCode) => {\n  throw new CEPError(error);\n};\n\nconst ehStringValida = (data: string): boolean => !!data && data.trim() !== '';\n\nconst hasMinLength = (data: string, minLength: number): boolean =>\n  data.trim().length >= minLength;\n\nconst hasMaxLength = (data: string, maxLength: number): boolean =>\n  data.trim().length <= maxLength;\n\nconst validarMunicipio = (municipio: string): void => {\n  if (!ehStringValida(municipio)) {\n    throwCepError(CEPErrorCode.MUNICIPIO_VAZIO);\n  }\n\n  if (!hasMinLength(municipio, 3)) {\n    throwCepError(CEPErrorCode.MUNICIPIO_MUITO_CURTO);\n  }\n};\n\nconst validarLogradouro = (logradouro: string): void => {\n  if (!ehStringValida(logradouro)) {\n    throwCepError(CEPErrorCode.LOGRADOURO_VAZIO);\n  }\n\n  if (!hasMinLength(logradouro, 3)) {\n    throwCepError(CEPErrorCode.LOGRADOURO_MUITO_CURTO);\n  }\n};\n\nconst validarUF = (uf: string): void => {\n  if (!ehStringValida(uf)) {\n    throwCepError(CEPErrorCode.UF_VAZIA);\n  }\n\n  if (!hasMinLength(uf, 2)) {\n    throwCepError(CEPErrorCode.UF_MUITO_CURTA);\n  }\n\n  if (!hasMaxLength(uf, 2)) {\n    throwCepError(CEPErrorCode.UF_MUITO_LONGA);\n  }\n\n  if (!UFS_VALIDAS.some((it) => it.toLowerCase() === uf.toLowerCase())) {\n    throwCepError(CEPErrorCode.UF_NAO_EXISTE);\n  }\n};\n\nexport const validarCEP = () => (\n  source: Observable<string>\n): Observable<string> =>\n  new Observable((subscriber) =>\n    source.subscribe({\n      next: (cep) => {\n        try {\n          const regex = new RegExp(/^[0-9]+$/);\n          if (!ehStringValida(cep)) {\n            throwCepError(CEPErrorCode.CEP_VAZIO);\n          }\n          if (!regex.test(cep)) {\n            throwCepError(CEPErrorCode.CEP_INVALIDO);\n          }\n          if (cep.length < 8) {\n            throwCepError(CEPErrorCode.CEP_MUITO_CURTO);\n          }\n          if (cep.length > 8) {\n            throwCepError(CEPErrorCode.CEP_MUITO_LONGO);\n          }\n          subscriber.next(cep.trim());\n        } catch (e) {\n          subscriber.error(e);\n        }\n      },\n      error: (error) => subscriber.error(error),\n      complete: () => subscriber.complete(),\n    })\n  );\n\ninterface EnderecoPesquisa {\n  uf: string;\n  logradouro: string;\n  municipio: string;\n}\n\nexport const validarEndereco = () => (\n  source: Observable<EnderecoPesquisa>\n): Observable<EnderecoPesquisa> =>\n  new Observable((subscriber) =>\n    source.subscribe({\n      next: ({ uf, logradouro, municipio }) => {\n        try {\n          validarUF(uf);\n          validarMunicipio(municipio);\n          validarLogradouro(logradouro);\n        } catch (e) {\n          subscriber.error(e);\n        }\n        subscriber.next({ uf, logradouro, municipio });\n      },\n      error: (error) => subscriber.error(error),\n      complete: () => subscriber.complete(),\n    })\n  );\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, of } from 'rxjs';\nimport { Endereco } from './model/endereco';\nimport { CEPErrorCode } from './model/cep-error-code';\nimport { CEPError } from './model/cep-error';\nimport { BASE_URL } from './model/constantes';\nimport { validarCEP, validarEndereco } from './utils';\nimport { map, switchMap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NgxViacepService {\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Busca o endere√ßo a partir do CEP\n   *\n   * @param cep\n   */\n  buscarPorCep(cep: string): Observable<Endereco> {\n    return of(cep).pipe(\n      validarCEP(),\n      switchMap((cepValido) =>\n        this.http.get<Endereco>(`${BASE_URL}/${cepValido}/json`)\n      ),\n      map((endereco) => {\n        if ('cep' in endereco) {\n          return endereco;\n        }\n        throw new CEPError(CEPErrorCode.CEP_NAO_ENCONTRADO);\n      })\n    );\n  }\n\n  /**\n   * Faz a busca aproximada\n   *\n   * @param uf\n   * @param municipio\n   * @param logradouro\n   */\n  buscarPorEndereco(\n    uf: string,\n    municipio: string,\n    logradouro: string\n  ): Observable<Endereco[]> {\n    return of({ uf, municipio, logradouro }).pipe(\n      validarEndereco(),\n      switchMap(() =>\n        this.http.get<Endereco[]>(\n          `${BASE_URL}/${uf}/${municipio}/${logradouro}/json`\n        )\n      )\n    );\n  }\n}\n","/*\n * Public API Surface of ngx-viacep\n */\n\nexport * from './lib/ngx-viacep.module';\nexport * from './lib/ngx-viacep.service';\nexport * from './lib/model/endereco';\nexport * from './lib/model/cep-error-code';\nexport * from './lib/model/cep-error';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}